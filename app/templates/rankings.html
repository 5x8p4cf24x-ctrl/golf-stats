{% extends "public_base.html" %}

{% block title %}Rankings{% endblock %}

{% block header %}
  <header class="public-header">
    <h1 class="public-title">Rankings</h1>
    <img src="/static/golfmode_logo.png" class="public-logo" alt="Golf Mode">
    <p class="public-subtitle">
      Clasificaciones globales por rendimiento y estadÃ­sticas.
    </p>
  </header>

  <div class="public-back-wrap">
    <a class="public-back" href="/public">â† Volver</a>
  </div>
{% endblock %}


{% block content %}

{% macro table_block(title, icon, subtitle, rows, key, fmt="%.1f") %}
  <section class="card rankings-card">
    <div class="rankings-card-head">
      <div>
        <div class="rankings-title-row">
          <h2 class="rankings-h2">{{ title }}</h2>
          {% if icon %}<span class="rankings-icon">{{ icon }}</span>{% endif %}
        </div>
        {% if subtitle %}<p class="rankings-sub">{{ subtitle }}</p>{% endif %}
      </div>
      <span class="rankings-chip">{{ rows|length }} jugadores</span>
    </div>

    <div class="rankings-table-wrap">
      <table class="rankings-table">
        <thead>
          <tr>
            <th class="c-rank">#</th>
            <th>Jugador</th>
            <th class="num">Valor</th>
            <th class="num">Vtas</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
          <tr class="{% if loop.index == 1 %}top1{% elif loop.index == 2 %}top2{% elif loop.index == 3 %}top3{% endif %}">
            <td class="c-rank">
              {% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% else %}{{ loop.index }}{% endif %}
            </td>
            <td>
              <a class="rankings-player-link" href="/players/{{ r.player.id }}">{{ r.player.name }}</a>
            </td>
            <td class="num">
              {% if r[key] is none %}-{% else %}{{ fmt|format(r[key]) }}{% endif %}
            </td>
            <td class="num">{{ r.rounds_played }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
{% endmacro %}

<section class="rankings-grid">
  {{ table_block("Media puntos Stableford", "ğŸ†", "HCP (mÃ¡s es mejor)", by_avg_pts, "avg_pts", "%.1f") }}
  {{ table_block("Media puntos Scratch", "â­", "Scratch (mÃ¡s es mejor)", by_avg_scr, "avg_scr", "%.1f") }}

  {{ table_block("Victorias", "ğŸ¥‡", "Desempate por empates", by_wins, "wins", "%d") }}
  {{ table_block("Putts por hoyo", "ğŸŸ£", "Menor es mejor", by_putts, "putts_per_hole", "%.2f") }}

  {{ table_block("FIR %", "ğŸ¯", "PrecisiÃ³n desde tee", by_fir, "fir_pct", "%.0f%%") }}
  {{ table_block("GIR %", "â›³", "Greens en regulaciÃ³n", by_gir, "gir_pct", "%.0f%%") }}

  {{ table_block("Birdies totales", "ğŸ¦", "Acumulado", by_birdies, "birdies", "%d") }}
  {{ table_block("Eagles totales", "ğŸ¦…", "Acumulado", by_eagles, "eagles", "%d") }}
</section>

{% endblock %}
